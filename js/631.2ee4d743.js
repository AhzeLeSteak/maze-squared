"use strict";(self["webpackChunkmaze_squared"]=self["webpackChunkmaze_squared"]||[]).push([[631],{4631:function(t,e,s){s.r(e),s.d(e,{default:function(){return g}});var i=s(3396),l=s(7139);const o={class:"centered",style:{display:"flex"}},a={class:"toolbox"},n=["onClick"],r=(0,i._)("canvas",{id:"top-view"},null,-1);function h(t,e,s,h,c,y){return(0,i.wg)(),(0,i.iD)("div",o,[(0,i._)("div",a,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.buttons,(t=>((0,i.wg)(),(0,i.iD)("button",{onClick:e=>t.onclick(),style:(0,l.j5)(t.style)},null,12,n)))),256))]),r])}var c=s(2482),y=s(954);class p{constructor(t,e,s){(0,c.Z)(this,"tile_size",void 0),(0,c.Z)(this,"game",void 0),this.tile_size=e,this.game=s,this.tile_size=e;const i=t=>{const e=this.getPos(t);t.preventDefault(),this.game.map.setBox(e,0===t.button?1:0)},l=t=>{const e=this.getPos(t);0===s.map.box(e.x,e.y)&&(s.player.pos={...e},s.player.pos.x+=.5,s.player.pos.y+=.5,s.map.map_info.playerPos=e)};t.addEventListener("click",i),t.addEventListener("dblclick",l),document.oncontextmenu=t=>{t.preventDefault(),i(t)}}getPos(t){return{x:Math.floor(t.offsetX/this.tile_size),y:Math.floor(t.offsetY/this.tile_size)}}}var d=s(2201);class _ extends d.H{constructor(t,e,s){super({x:t.map.size.y*e,y:t.map.size.y*e},s),(0,c.Z)(this,"tile_size",void 0),(0,c.Z)(this,"lvl_editor",void 0),(0,c.Z)(this,"last_player_pos",void 0),this.tile_size=e,this.lvl_editor=new p(this.canvas,this.tile_size,t),this.last_player_pos={x:1/0,y:1/0}}drawContext(t){this.reset(),this.contextd2D.strokeStyle="black",this.contextd2D.font=Math.floor(.3*this.tile_size)+"px Comic sans";const e=t.map;for(let h=0;h<e.size.y;h++)for(let t=0;t<e.size.x;t++){const s=e.box(t,h);switch(s){case 0:this.contextd2D.fillStyle="grey";break;case 1:this.contextd2D.fillStyle="black";break;default:this.contextd2D.fillStyle="yellow"}this.drawSquare(t*this.tile_size+1,h*this.tile_size+1,this.tile_size-2,this.tile_size-2),s>1&&this.contextd2D.strokeText(""+(s-1),(t+.45)*this.tile_size,(h+.6)*this.tile_size)}const s={...t.player.pos},i={x:Math.floor(s.x),y:Math.floor(s.y)};i.x!==this.last_player_pos.x&&i.y!==this.last_player_pos.y&&t.map.box(i.x,i.y)>1&&(this.last_player_pos=i,console.warn("Player standing on teleporter ",s)),s.x*=this.tile_size,s.y*=this.tile_size;const l=Math.floor(t.player.pos.x)*this.tile_size,o=Math.floor(t.player.pos.y)*this.tile_size;this.contextd2D.fillStyle="rgba(100, 250, 100, 0.4)",this.drawSquare(l+1,o+1,this.tile_size-2,this.tile_size-2);for(let h=-t.view_angle/2;h<t.view_angle/2;h++)for(let s=0;s<1;s++){const i=t.player.angle+(h+s/2)*y.Ly,l=e.getNextPoint(t.player.pos,i);"HORIZONTAL"===l.from?this.setColor(55,200,40):this.setColor(50,85,255),this.setColor(255,250,500);for(const t of l.pointsToDraw)this.drawSquare(t.x*this.tile_size-2,t.y*this.tile_size-2,4,4);for(let t=1;t<l.pointsToDraw.length;t++){const e=l.pointsToDraw[t-1],s=l.pointsToDraw[t];if(!l.pointBreak.includes(t))for(let t=0;t<4;t++)this.drawLine(e.x*this.tile_size,e.y*this.tile_size,s.x*this.tile_size,s.y*this.tile_size),this.drawLine(e.x*this.tile_size+t,e.y*this.tile_size+t,s.x*this.tile_size+t,s.y*this.tile_size+t)}}this.contextd2D.strokeStyle="red",this.contextd2D.fillStyle="red";const a=8;this.drawSquare(s.x-a/2,s.y-a/2,a,a);const n=s.x+Math.cos(t.player.angle)*this.tile_size/2,r=s.y+Math.sin(t.player.angle)*this.tile_size/2;this.drawLine(s.x,s.y,n,r),this.contextd2D.fillStyle="black",this.contextd2D.font="16px Comic sans",this.contextd2D.fillText((t.player.angle/y.Ly+"").substr(0,5),s.x+10,s.y+10)}}const x=t=>`background-image: url("assets/ui/toolbox/${t}.png")`;var u=(0,i.aZ)({name:"Edit",props:{game:{type:Object,required:!0}},data(){return{buttons:[{style:x("wall_floor"),onclick:()=>{console.log("a")}}]}},mounted(){const t=new _(this.game,64,document.getElementById("top-view"));this.game.loop([t])},unmounted(){this.game.stop()}}),f=s(89);const z=(0,f.Z)(u,[["render",h]]);var g=z}}]);
//# sourceMappingURL=631.2ee4d743.js.map